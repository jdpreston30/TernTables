% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ternD.R
\name{ternD}
\alias{ternD}
\title{Generate descriptive summary table (optionally normality-aware)}
\usage{
ternD(
  data,
  vars = NULL,
  exclude_vars = NULL,
  force_ordinal = NULL,
  output_xlsx = NULL,
  output_docx = NULL,
  consider_normality = TRUE,
  print_normality = FALSE,
  round_intg = FALSE,
  smart_rename = TRUE,
  insert_subheads = TRUE,
  factor_order = "levels",
  methods_doc = TRUE,
  methods_filename = "TernTables_methods.docx",
  category_start = NULL,
  table_font_size = 9,
  manual_italic_indent = NULL,
  manual_underline = NULL
)
}
\arguments{
\item{data}{Tibble with variables.}

\item{vars}{Character vector of variables to summarize. Defaults to all except \code{exclude_vars}.}

\item{exclude_vars}{Character vector to exclude from the summary.}

\item{force_ordinal}{Character vector of variables to treat as ordinal (i.e., use median [IQR]) 
regardless of the \code{consider_normality} setting. This parameter takes priority over 
normality testing when \code{consider_normality = TRUE}.}

\item{output_xlsx}{Optional Excel filename to export the table.}

\item{output_docx}{Optional Word filename to export the table.}

\item{consider_normality}{Logical; if \code{TRUE} (default), uses Shapiro-Wilk test to choose between
mean +/- SD (for normal data) vs median [IQR] (for non-normal data) for numeric variables.
If \code{FALSE}, defaults to mean +/- SD for all numeric variables unless specified in
\code{force_ordinal}.}

\item{print_normality}{Logical; if \code{TRUE}, includes Shapiro-Wilk P values as an
additional column in the output. Default is \code{FALSE}.}

\item{round_intg}{Logical; if \code{TRUE}, rounds all means, medians, IQRs, and standard 
deviations to nearest integer (0.5 rounds up). Default is \code{FALSE}.}

\item{smart_rename}{Logical; if \code{TRUE}, automatically cleans variable names and
subheadings for publication-ready output using built-in rule-based pattern matching for
common medical abbreviations and prefixes. Default is \code{TRUE}.}

\item{insert_subheads}{Logical; if \code{TRUE} (default), creates a hierarchical structure with a header row and
indented sub-category rows for categorical variables with 3 or more levels. Binary variables
(Y/N, YES/NO, or numeric 1/0 -- which are auto-detected and treated as Y/N) are always displayed
as a single row showing the positive/yes count regardless of this setting. Two-level categorical
variables whose values are not Y/N, YES/NO, or 1/0 (e.g. Male/Female) use the hierarchical
sub-row format, showing both levels as indented rows.
If \code{FALSE}, all categorical variables use a single-row flat format. Default is \code{TRUE}.}

\item{factor_order}{Character; controls the ordering of factor levels in the output. If
\code{"levels"} (default), respects the original factor level ordering as defined in the data;
if the variable is not a factor, falls back to frequency ordering. If \code{"frequency"},
orders levels by decreasing frequency (most common first).}

\item{methods_doc}{Logical; if \code{TRUE} (default), generates a methods document
describing the statistical presentation used. The document contains boilerplate
text for all three table types so the relevant section can be copied directly
into a manuscript.}

\item{methods_filename}{Character; filename for the methods document.
Default is \code{"TernTables_methods.docx"}.}

\item{category_start}{Named character vector specifying where to insert category headers.
Names are the header label text to display; values are the anchor variable -- either the
original column name (e.g. \code{"Age_Years"}) or the cleaned display name
(e.g. \code{"Age (yr)"}). Both forms are accepted.
Example: \code{c("Demographics" = "Age_Years", "Clinical Measures" = "bmi")}.
Default is \code{NULL} (no category headers).}

\item{table_font_size}{Numeric; font size for Word document output tables. Default is 9.}

\item{manual_italic_indent}{Character vector of display variable names (post-cleaning) that should be
formatted as italicized and indented in Word output -- matching the appearance of factor sub-category
rows. Has no effect on the returned tibble; only applies when \code{output_docx} is specified.
Default is \code{NULL}.}

\item{manual_underline}{Character vector of display variable names (post-cleaning) that should be
formatted as underlined in Word output -- matching the appearance of multi-category variable headers.
Has no effect on the returned tibble; only applies when \code{output_docx} is specified.
Default is \code{NULL}.}
}
\value{
A tibble with one row per variable (multi-row for factors), containing:
\describe{
  \item{Variable}{Variable names with appropriate indentation}
  \item{Total (N = n)}{Summary statistics (mean +/- SD, median [IQR], or n (\%) as appropriate)}
  \item{SW_p}{Shapiro-Wilk P values (only if \code{print_normality = TRUE})}
}
}
\description{
Creates a descriptive summary table with a single "Total" column format.
By default (\code{consider_normality = TRUE}), continuous variables are shown
as mean +/- SD or median [IQR] based on Shapiro-Wilk testing. This can be
overridden via \code{consider_normality} and \code{force_ordinal}.
}
\details{
The function always returns a tibble with a single \code{Total (N = n)} column format, regardless of the
\code{consider_normality} setting. The behavior for numeric variables follows this priority:
\enumerate{
  \item Variables in \code{force_ordinal}: Always use median [IQR]
  \item When \code{consider_normality = TRUE}: Use Shapiro-Wilk test to choose format
  \item When \code{consider_normality = FALSE}: Default to mean +/- SD
}

For categorical variables, the function shows frequencies and percentages. When
\code{insert_subheads = TRUE}, categorical variables with 3 or more levels are displayed with
hierarchical formatting (main variable as header, levels as indented sub-rows). Binary variables
(Y/N, YES/NO, or numeric 1/0 auto-detected as Y/N) always use a single-row format showing
only the positive/yes count, regardless of this setting. Two-level categorical variables whose
values are not Y/N, YES/NO, or 1/0 (e.g. Male/Female) also use the hierarchical sub-row format.
}
\examples{
data(tern_colon)

# Basic descriptive summary
ternD(tern_colon, exclude_vars = c("ID"))

# With normality-aware formatting and category section headers
ternD(tern_colon, exclude_vars = c("ID"),
      category_start = c("Patient Demographics"  = "Age (yr)",
                         "Tumor Characteristics" = "Positive Lymph Nodes (n)"))

# Force specific variables to ordinal (median [IQR]) display
ternD(tern_colon, exclude_vars = c("ID"),
      force_ordinal = c("Positive_Lymph_Nodes_n"))

# Export to Word (writes a file -- not run during automated checks)
\dontrun{
ternD(tern_colon,
      exclude_vars     = c("ID"),
      output_docx      = file.path(tempdir(), "descriptive.docx"),
      category_start   = c("Patient Demographics"  = "Age (yr)",
                           "Surgical Findings"     = "Colonic Obstruction",
                           "Tumor Characteristics" = "Positive Lymph Nodes (n)",
                           "Outcomes"              = "Recurrence"))
}
}
