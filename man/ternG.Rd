% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ternG.R
\name{ternG}
\alias{ternG}
\title{Generate grouped summary table with appropriate statistical tests}
\usage{
ternG(
  data,
  vars = NULL,
  exclude_vars = NULL,
  group_var,
  force_ordinal = NULL,
  group_order = NULL,
  output_xlsx = NULL,
  output_docx = NULL,
  OR_col = FALSE,
  OR_method = "dynamic",
  consider_normality = TRUE,
  print_normality = FALSE,
  show_test = FALSE,
  p_digits = 3,
  round_intg = FALSE,
  smart_rename = TRUE,
  insert_subheads = TRUE,
  factor_order = "levels",
  table_font_size = 9,
  methods_doc = TRUE,
  methods_filename = "TernTables_methods.docx",
  category_start = NULL,
  manual_italic_indent = NULL,
  manual_underline = NULL,
  indent_info_column = FALSE,
  show_total = TRUE
)
}
\arguments{
\item{data}{Tibble containing all variables.}

\item{vars}{Character vector of variables to summarize. Defaults to all except \code{group_var} and \code{exclude_vars}.}

\item{exclude_vars}{Character vector of variable(s) to exclude. \code{group_var} is automatically excluded.}

\item{group_var}{Character, the grouping variable (factor or character with >=2 levels).}

\item{force_ordinal}{Character vector of variables to treat as ordinal (i.e., use medians/IQR and nonparametric tests).}

\item{group_order}{Optional character vector to specify a custom group level order.}

\item{output_xlsx}{Optional filename to export the table as an Excel file.}

\item{output_docx}{Optional filename to export the table as a Word document.}

\item{OR_col}{Logical; if \code{TRUE}, adds odds ratios with 95\% CI for binary categorical variables.
Only valid when \code{group_var} has exactly 2 levels; an error is raised for 3+ group comparisons.
Default is \code{FALSE}.}

\item{OR_method}{Character; controls how odds ratios are calculated when \code{OR_col = TRUE}.
If \code{"dynamic"} (default), uses Fisher's exact method when any expected cell count is < 5
(Cochran criterion), otherwise uses the Wald method. If \code{"wald"}, forces the Wald method
regardless of expected cell counts.}

\item{consider_normality}{Logical or character; controls how continuous variables are tested and displayed.
If \code{TRUE} (default), runs the Shapiro-Wilk test per group for each numeric variable; a variable is treated
as normally distributed only if all groups pass (p > 0.05). Normal variables use mean \eqn{\pm} SD
and Welch t-test (2 groups) or ANOVA (3+ groups); non-normal variables use median [IQR] and Wilcoxon
rank-sum (2 groups) or Kruskal-Wallis (3+ groups). When Shapiro-Wilk cannot be computed (n < 3 in
any group), that variable is treated as non-normal (conservative fail-safe).
If \code{FALSE}, all numeric variables are treated as normally distributed (mean \eqn{\pm} SD,
parametric tests) regardless of distribution, unless listed in \code{force_ordinal}.
If \code{"FORCE"}, all numeric variables are treated as non-normal (median [IQR], nonparametric tests)
regardless of Shapiro-Wilk results.}

\item{print_normality}{Logical; if \code{TRUE}, includes Shapiro-Wilk P values in the output. Default is \code{FALSE}.}

\item{show_test}{Logical; if \code{TRUE}, includes the statistical test name as a column in the output. Default is \code{FALSE}.}

\item{p_digits}{Integer; number of decimal places for P values (default 3).}

\item{round_intg}{Logical; if \code{TRUE}, rounds all means, medians, IQRs, and standard deviations to nearest integer (0.5 rounds up). Default is \code{FALSE}.}

\item{smart_rename}{Logical; if \code{TRUE}, automatically cleans variable names and subheadings for publication-ready output using built-in rule-based pattern matching for common medical abbreviations and prefixes. Default is \code{TRUE}.}

\item{insert_subheads}{Logical; if \code{TRUE} (default), creates a hierarchical structure with a header row and
indented sub-category rows for categorical variables with 3 or more levels. Binary variables
(Y/N, YES/NO, or numeric 1/0 -- which are auto-detected and treated as Y/N) are always displayed
as a single row showing the positive/yes count regardless of this setting. Two-level categorical
variables whose values are not Y/N, YES/NO, or 1/0 (e.g. Male/Female) use the hierarchical
sub-row format, showing both levels as indented rows.
If \code{FALSE}, all categorical variables use a single-row flat format. Default is \code{TRUE}.}

\item{factor_order}{Character; controls the ordering of factor levels in the output. If \code{"levels"} (default), respects the original factor level ordering as defined in the data; if the variable is not a factor, falls back to frequency ordering. If \code{"frequency"}, orders levels by decreasing frequency (most common first).}

\item{table_font_size}{Numeric; font size for Word document output tables. Default is 9.}

\item{methods_doc}{Logical; if \code{TRUE} (default), generates a methods document describing the statistical tests used.}

\item{methods_filename}{Character; filename for the methods document. Default is \code{"TernTables_methods.docx"}.}

\item{category_start}{Named character vector specifying where to insert category headers.
Names are the header label text to display; values are the anchor variable -- either the
original column name (e.g. \code{"Age_Years"}) or the cleaned display name
(e.g. \code{"Age (yr)"}). Both forms are accepted.
Example: \code{c("Demographics" = "Age_Years", "Clinical" = "bmi")}.
Default is \code{NULL} (no category headers).}

\item{manual_italic_indent}{Character vector of display variable names (post-cleaning) that should be
formatted as italicized and indented in Word output -- matching the appearance of factor sub-category
rows. Has no effect on the returned tibble; only applies when \code{output_docx} is specified or when
the tibble is passed to \code{word_export}.}

\item{manual_underline}{Character vector of display variable names (post-cleaning) that should be
formatted as underlined in Word output -- matching the appearance of multi-category variable headers.
Has no effect on the returned tibble; only applies when \code{output_docx} is specified or when
the tibble is passed to \code{word_export}.}

\item{indent_info_column}{Logical; if \code{FALSE} (default), the internal \code{.indent} helper column
is dropped from the returned tibble. Set to \code{TRUE} to retain it -- this is necessary when you
intend to post-process the tibble and later pass it to \code{word_export} directly, as
\code{word_export} uses the \code{.indent} column to apply correct indentation and italic formatting
in the Word table.}

\item{show_total}{Logical; if \code{TRUE}, adds a "Total" column showing the aggregate summary statistic across all groups (e.g., for a publication Table 1 that includes both per-group and overall columns). Default is \code{TRUE}.}
}
\value{
A tibble with one row per variable (multi-row for multi-level factors), showing summary statistics by group,
P values, test type, and optionally odds ratios and total summary column.
}
\description{
Creates a grouped summary table with optional statistical testing for group
comparisons. Supports numeric and categorical variables; numeric variables
can be treated as ordinal via \code{force_ordinal}. Includes options to
calculate P values and odds ratios. For descriptive
(ungrouped) tables, use \code{ternD}.
}
\examples{
data(tern_colon)

# 2-group comparison
ternG(tern_colon, exclude_vars = c("ID"), group_var = "Recurrence",
      methods_doc = FALSE)

# 2-group comparison with odds ratios
ternG(tern_colon, exclude_vars = c("ID"), group_var = "Recurrence",
      OR_col = TRUE, methods_doc = FALSE)

# 3-group comparison
ternG(tern_colon, exclude_vars = c("ID"), group_var = "Treatment_Arm",
      group_order = c("Observation", "Levamisole", "Levamisole + 5FU"),
      methods_doc = FALSE)

# Export to Word (writes a file -- not run during automated checks)
\dontrun{
ternG(tern_colon,
      exclude_vars   = c("ID"),
      group_var      = "Recurrence",
      OR_col         = TRUE,
      output_docx    = file.path(tempdir(), "comparison.docx"),
      category_start = c("Patient Demographics"  = "Age (yr)",
                         "Tumor Characteristics" = "Positive Lymph Nodes (n)"))
}

}
