% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ternG.R
\name{ternG}
\alias{ternG}
\title{Generate grouped summary table with appropriate statistical tests}
\usage{
ternG(
  data,
  vars = NULL,
  exclude_vars = NULL,
  group_var,
  force_ordinal = NULL,
  group_order = NULL,
  output_xlsx = NULL,
  output_docx = NULL,
  OR_col = FALSE,
  OR_method = "dynamic",
  consider_normality = TRUE,
  print_normality = FALSE,
  show_test = FALSE,
  p_digits = 3,
  round_intg = FALSE,
  smart_rename = TRUE,
  insert_subheads = TRUE,
  factor_order = "levels",
  table_font_size = 9,
  methods_doc = TRUE,
  methods_filename = "TernTables_methods.docx",
  category_start = NULL,
  manual_italic_indent = NULL,
  manual_underline = NULL,
  indent_info_column = FALSE,
  show_total = TRUE
)
}
\arguments{
\item{data}{Tibble containing all variables.}

\item{vars}{Character vector of variables to summarize. Defaults to all except \code{group_var} and \code{exclude_vars}.}

\item{exclude_vars}{Character vector of variable(s) to exclude. \code{group_var} is automatically excluded.}

\item{group_var}{Character, the grouping variable (factor or character with >=2 levels).}

\item{force_ordinal}{Character vector of variables to treat as ordinal (i.e., use medians/IQR and nonparametric tests).}

\item{group_order}{Optional character vector to specify a custom group level order.}

\item{output_xlsx}{Optional filename to export the table as an Excel file.}

\item{output_docx}{Optional filename to export the table as a Word document.}

\item{OR_col}{Logical; if \code{TRUE}, adds odds ratios with 95\% CI for binary categorical variables.
Only valid when \code{group_var} has exactly 2 levels; an error is raised for 3+ group comparisons.}

\item{OR_method}{Character; if \code{"dynamic"}, uses Fisher/Wald based on test type. If \code{"wald"}, forces Wald method.}

\item{consider_normality}{Logical or character; if \code{TRUE}, uses Shapiro-Wilk to choose t-test vs. Wilcoxon for numeric vars. If \code{FALSE}, uses variable type and force_ordinal. If \code{"FORCE"}, treats all numeric variables as ordinal (median/IQR, nonparametric tests).}

\item{print_normality}{Logical; if \code{TRUE}, includes Shapiro-Wilk p-values in the output.}

\item{show_test}{Logical; if \code{TRUE}, includes the statistical test name as a column in the output. Default is \code{FALSE}.}

\item{p_digits}{Integer; number of decimal places for p-values (default 3).}

\item{round_intg}{Logical; if \code{TRUE}, rounds all means, medians, IQRs, and standard deviations to nearest integer (0.5 rounds up). Default is \code{FALSE}.}

\item{smart_rename}{Logical; if \code{TRUE}, automatically cleans variable names and subheadings for publication-ready output using built-in rule-based pattern matching for common medical abbreviations and prefixes. Default is \code{TRUE}.}

\item{insert_subheads}{Logical; if \code{TRUE}, creates hierarchical structure with headers and indented sub-categories for multi-level categorical variables (except Y/N). If \code{FALSE}, uses simple flat format. Default is \code{TRUE}.}

\item{factor_order}{Character; controls the ordering of factor levels in the output. If \code{"levels"} (default), respects the original factor level ordering as defined in the data; if the variable is not a factor, falls back to frequency ordering. If \code{"frequency"}, orders levels by decreasing frequency (most common first).}

\item{table_font_size}{Numeric; font size for Word document output tables. Default is 9.}

\item{methods_doc}{Logical; if \code{TRUE} (default), generates a methods document describing the statistical tests used.}

\item{methods_filename}{Character; filename for the methods document. Default is \code{"TernTables_methods.docx"}.}

\item{category_start}{Named character vector specifying where to insert category headers.
Names are the header label text to display; values are the anchor variable â€” either the
original column name (e.g. \code{"Age_Years"}) or the cleaned display name
(e.g. \code{"Age (yr)"}). Both forms are accepted.
Example: \code{c("Demographics" = "Age_Years", "Clinical" = "bmi")}.
Default is \code{NULL} (no category headers).}

\item{manual_italic_indent}{Character vector; optional parameter for specifying which variable names should be italicized and indented in formatted outputs. Used for advanced formatting control.}

\item{manual_underline}{Character vector; optional parameter for specifying which variable names should be underlined in formatted outputs. Used for advanced formatting control.}

\item{indent_info_column}{Logical; if \code{FALSE} (default), the internal \code{.indent} helper column is dropped from the returned tibble. Set to \code{TRUE} to retain it.}

\item{show_total}{Logical; if \code{TRUE}, adds a "Total" column showing the aggregate summary statistic across all groups (e.g., for a publication Table 1 that includes both per-group and overall columns). Default is \code{TRUE}.}
}
\value{
A tibble with one row per variable (multi-row for multi-level factors), showing summary statistics by group,
p-values, test type, and optionally odds ratios and total summary column.
}
\description{
Creates a grouped summary table with optional statistical testing for group
comparisons. Supports numeric, ordinal, and categorical variables, and
includes options to calculate p-values and odds ratios. For descriptive
(ungrouped) tables, use \code{ternD}.
}
\examples{
# Basic 2-group comparison with built-in dataset
ternG(mtcars, group_var = "am")

# 2-group comparison using the bundled clinical dataset
data(tern_colon)
ternG(tern_colon, exclude_vars = c("ID"), group_var = "Recurrence",
      consider_normality = TRUE, OR_col = TRUE)

# 3-group comparison
ternG(tern_colon, exclude_vars = c("ID"), group_var = "Treatment_Arm",
      group_order = c("Observation", "Levamisole", "Levamisole + 5FU"),
      consider_normality = TRUE)

}
